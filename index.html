<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 U.S. Olympic Trials Tracker</title>
    <meta name="description" content="Scoring system for Mass Start Olympic Team Trials">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="print-only print-header">
        <div class="print-title">
            <h1 style="margin:0; font-size: 24px;">2026 U.S. Olympic Team Trials</h1>
            <h2 id="print-race-title" style="margin:5px 0; font-size: 18px;">Official Results</h2>
            <p id="print-meta" style="margin:0; font-size: 14px;">Utah Olympic Oval</p>
        </div>
    </div>

    <div class="app-container">
        <header class="header">
            <div class="header-content">
                <div class="logo-section" onclick="switchToTab('dashboard')" style="cursor: pointer;">
                    <div class="usa-badge"><span>USA</span></div>
                    <div class="title-group">
                        <h1>2026 U.S. Olympic Team Trials</h1>
                        <p class="subtitle">Unofficial Results & Qualification Tracker</p>
                    </div>
                </div>
                <nav class="nav-tabs">
                    <button class="nav-tab active" data-tab="dashboard">üìä Dashboard</button>
                    <button class="nav-tab" data-tab="olympic"
                        onclick="appState.currentTab='olympic'; renderCurrentTab()">The Team</button>
                    <button class="nav-tab admin-only" id="tab-events" data-tab="events">‚è±Ô∏è Event Entry</button>
                    <button class="nav-tab admin-only" id="tab-athletes" data-tab="athletes">üë§ Athletes</button>
                    <button class="nav-tab" data-tab="help">üìñ Rules & Info</button>
                    <button class="nav-tab" data-tab="results">üèÜ Standings</button>
                    <button class="nav-tab" onclick="shareApp()">üîó Share Tracker</button>
                </nav>
            </div>
        </header>
        <main class="main-content" id="main-content"></main>
        <div id="modal-container"></div>

        <!-- Admin Login Modal (Hardcoded for stability) -->
        <div id="admin-modal"
            style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 10000; align-items: center; justify-content: center; backdrop-filter: blur(5px);">
            <div
                style="background: rgba(13, 17, 23, 0.95); padding: 40px; border-radius: 16px; border: 1px solid rgba(212, 175, 55, 0.3); text-align: center; width: 320px; box-shadow: 0 0 30px rgba(0,0,0,0.7);">
                <h3
                    style="margin-top: 0; color: #D4AF37; font-size: 1.5em; text-transform: uppercase; letter-spacing: 2px;">
                    Admin Access</h3>
                <p style="color: #888; margin-bottom: 20px; font-size: 0.9em;">Authorized Personnel Only</p>
                <input type="password" id="admin-pw-input" class="form-control" placeholder="ENTER PASSWORD"
                    style="margin: 20px 0; text-align: center; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); color: #fff; padding: 12px; border-radius: 8px;">
                <div style="display: flex; gap: 10px; justify-content: center;">
                    <button class="btn" onclick="checkAdminPassword()"
                        style="background: #D4AF37; color: #000; font-weight: bold; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer;">UNLOCK</button>
                    <button class="btn" onclick="closeAdminModal()"
                        style="background: transparent; color: #888; border: 1px solid #444; padding: 12px 24px; border-radius: 6px; cursor: pointer;">CANCEL</button>
                </div>
            </div>
        </div>
        <footer class="footer">
            <div class="footer-controls">
                <button class="acrs-toggle admin-only" onclick="openAcrsModal()">üìä ACRS Points Table</button>
                <button id="admin-login-btn" class="acrs-toggle" onclick="toggleAdminMode()"
                    style="background:transparent; border:1px solid #444; margin-left:10px;">üîí Admin</button>
            </div>
            <div class="footer-info">
                <p>Olympic Trials Tracker</p>
                <p class="branding-text">Powered by <a href="https://saltygoldsupply.com" target="_blank"
                        class="salty-link">Salty Gold Supply</a></p>
            </div>
        </footer>
    </div>
    <div class="print-only print-footer">
        <div style="margin-top: 40px; display: flex; justify-content: flex-start;">
            <div style="border-top: 1px solid black; width: 40%; padding-top: 5px;">Chief Referee</div>
        </div>
        <p style="text-align: center; font-size: 10px; margin-top: 20px;">Generated by Olympic Trials Tracker | 2026
            Olympic Team Trials</p>
    </div>
    <div id="share-overlay" class="share-overlay" style="display:none;">
        <div class="share-modal">
            <button class="close-share" onclick="closeShareModal()">√ó</button>
            <h3>üì± Instagram Share Card</h3>
            <p style="color:#aaa; font-size:0.9em; margin-bottom:15px;">Download this image to share on Stories or Feed!
            </p>

            <div id="capture-target" class="ig-card">
                <!-- Header Removed -->
                <div class="ig-content">
                    <div class="ig-qualified-label">CONGRATULATIONS TO THE OFFICIALLY UNOFFICIAL TEAM MEMBER</div>
                    <h1 id="share-athlete-name">ATHLETE NAME</h1>
                    <div class="ig-events-label">EVENTS</div>
                    <div id="share-athlete-events" class="ig-events-list">
                        <span>500m</span><span>1000m</span>
                    </div>
                </div>
                <div class="ig-footer">
                    <p>OLYMPIC TRIALS TRACKER</p>
                    <p class="ig-brand">Powered by SaltyGoldSupply.com</p>
                </div>
            </div>

            <button class="btn btn-primary share-download-btn" onclick="downloadShareCard()">‚¨áÔ∏è Download Image</button>
        </div>
    </div>

    <!-- Image generation libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="preload_data.js"></script>
    <script src="config.js"></script>
    <script src="skaters_to_watch.js"></script>
    <script src="data-manager.js"></script>
    <script src="app.js"></script>
    <script>
        // Override Admin Logic for Stability
        window.toggleAdminMode = function () {
            if (!appState.isAdmin) {
                const modal = document.getElementById('admin-modal');
                if (modal) {
                    modal.style.display = 'flex';
                    const input = document.getElementById('admin-pw-input');
                    if (input) {
                        setTimeout(() => input.focus(), 100);
                        input.onkeydown = (e) => {
                            if (e.key === 'Enter') window.checkAdminPassword();
                            if (e.key === 'Escape') window.closeAdminModal();
                        };
                    }
                }
            } else {
                appState.isAdmin = false;
                document.body.classList.remove('admin-mode');
                document.getElementById('admin-login-btn').innerText = "üîí Admin";
                if (['events', 'athletes'].includes(appState.currentTab)) {
                    appState.currentTab = 'dashboard';
                    document.querySelector('.nav-tab.active')?.classList.remove('active');
                    document.querySelector('[data-tab="dashboard"]').classList.add('active');
                }
                renderCurrentTab();
            }
        };

        window.closeAdminModal = function () {
            const modal = document.getElementById('admin-modal');
            if (modal) modal.style.display = 'none';
        };

        window.checkAdminPassword = function () {
            const input = document.getElementById('admin-pw-input');
            const password = input.value;
            if (password === "admin123") {
                appState.isAdmin = true;
                document.body.classList.add('admin-mode');
                document.getElementById('admin-login-btn').innerText = "üîì Admin Active";
                window.closeAdminModal();
                renderCurrentTab();
                input.value = '';
                if (typeof showToast === 'function') showToast('Admin Access Granted');
            } else {
                alert("Incorrect Password");
                input.value = '';
                input.focus();
            }
        };
    </script>
    <div id="toast-container" style="position:fixed; bottom:20px; right:20px; z-index:9999;"></div>
</body>

</html>